<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Genre List</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/genre-list.css">
    <style>
        .selected-card {
            background-color: #d3d3d3; /* Светло-серый цвет для выделенной карточки */
            transition: background-color 0.3s;
        }
        .genre-card:hover {
            cursor: pointer;
            background-color: #f0f0f0; /* Легкий серый оттенок при наведении */
        }
    </style>
</head>
<body>
<header th:insert="~{blocks/header :: header}"></header>
<div class="d-flex justify-content-center mt-5 mb-5">
    <div class="container text-center">
        <h1 class="mb-4">Список жанрів</h1>
        <div class="row">
            <!-- Перебор списка жанров и отображение каждого жанра -->
            <div th:each="genre : ${genreList}" class="col-md-6 col-lg-4 mb-4">
                <div class="card h-100 genre-card" th:data-genre-name="${genre.genreName}" onclick="toggleGenre(this)">
                    <div class="card-body">
                        <h5 class="card-title">
                            <a href="javascript:void(0)" th:text="${genre.genreName}"></a>
                        </h5>
                    </div>
                </div>
            </div>
        </div>
        <!-- Добавление кнопки "поиск" внизу страницы -->
        <div class="row mt-4">
            <div class="col-12">
                <form id="searchForm" method="get" class="d-inline">
                    <input type="hidden" id="selectedGenres" name="genreNames" />
                    <button type="submit" class="btn btn-primary" id="searchButton" disabled>Поиск</button>
                </form>
            </div>
        </div>
    </div>
</div>
<footer th:insert="~{/blocks/footer :: footer}"></footer>

<script>
    let selectedGenres = [];

    function toggleGenre(card) {
        const genreName = card.getAttribute('data-genre-name');

        if (selectedGenres.includes(genreName)) {
            selectedGenres = selectedGenres.filter(name => name !== genreName);
            card.classList.remove('selected-card');
        } else {
            selectedGenres.push(genreName);
            card.classList.add('selected-card');
        }

        // Обновление значения скрытого поля input
        document.getElementById('selectedGenres').value = selectedGenres.join(',');

        // Включение или отключение кнопки "Поиск"
        document.getElementById('searchButton').disabled = selectedGenres.length === 0;

        // Обновление action формы
        document.getElementById('searchForm').action = '/genre/search';
    }
</script>
</body>
</html>